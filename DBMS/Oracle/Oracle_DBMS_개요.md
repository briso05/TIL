# Database
- DB의 용도 : 데이터 저장 및 관리
- **관계형 데이터베이스**의 데이터 관리 방식 : 2차원 테이블 형식로 관리 (엑셀 sheet 처럼!)
  - 여러 개의 테이블을 생성하여 테이블끼리 연결하여(관계를 맺어주어) 관리한다.
    - 실제로 하나의 테이블로 저장할 수 있는데, 그렇게 관리하면 비효율적인 부분이 발생함  
    - :arrow_right: 데이터를 테이블을 분리하고, 이를 연결하여(관계를 맺으면서) 사용
  - 여러 테이블이 관계를 맺으면서 관리되기 때문에 **관계형데이터베이스(관계형DB, Relational DB, RDB)** 이라고 한다.  

  > ##### JDBC
  > - JAVA에서 DB에 접속하게 해주는 라이브러리
  > - DB 종류에 의존적이지 않음
  > - 동일한 방식으로 접근 가능 ( 일관성 )

### 대표적인 관계형 데이터베이스
- Oracle
- MySQL (MariaDB)
- DB2
- MS-MySQL

### SQL
- 관계형 DB를 다룰 때 사용하는 언어  
- 모든 DB에서 공통으로 사용하는 표준 SQL(ANSI)가 존재  
    :point_right: 하나의 RDB 학습하면, 다른 RBD 배우기 수월
- 그러나, 벤더의 특화 SQL 존재 :arrow_right: DB 마다 사용하는 SQL 문이 조금씩 다름
    :point_right: 표준 SQL 학습한 뒤 특정 DB에서만 사용가능한 SQL 문은 DB 마다 따로 정리해두는 것 추천📌

## Oracle DB 작동방식 및 구조
- 자세한 설명은 [여기](https://unabated.tistory.com/entry/%EC%98%A4%EB%9D%BC%ED%81%B4-%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C%EC%9D%98-%EA%B0%9C%EC%9A%94) 참고
### 구조
- 물리적 파일 영역 ➕ 메모리 / 프로세스 영역 (인스턴스)
#### 메모리 / 프로세스 영역
- 휘발성 영역 : 오라클 DBMS를 종료시키면 해당 영역은 제거됨
    - pc를 종료하면 메모리 영역은 다 날라가기 때문에, 물리적인 파일에 저장해야 함 :point_right: 물리적 파일 영역 존재 이유
- 메모리 : SGA(System Global Area) 라고 함
- 프로세스  : background process 라고 함  
    :point_right: 이 둘을 합쳐서 **인스턴스(instance)** 라고 함

#### 물리적 파일 영역
- 비휘발성 영역 : 영속성 지님  
- 물리적 파일(데이터베이스 파일)
    - `C:\oraclexe\app\oracle\oradata` 디렉토리에 DBMS에서 저장하는 물리적 파일(데이터베이스 파일) 존재 (확장자 : `.dbf`)
    - 종류
      - 사용자 파일 : 사용자가 생성하는 테이블 내 저장된 데이터
        - USERS.dbf 가 여기에 해당
      - 메타 데이터 파일 : 데이터의 데이터로, DBMS에서 데이터를 관리하기 위한 데이터
        - 컬럼정보, 테이블명, 사용자 계정, 권한정보 등 존재
        - CONTROL.dbf, SYSAUX.dbf, SYSTEM.dbf 가 여기에 해당
    - 이들은 바이너리 파일이기 때문에 일반 에디터로 확인 불가능
    - 또한 함부로 지우면 안되는 파일

### 작동방식
- PC에서 오라클 DB 설치하면, 이들은 서비스로 등록되고 PC의 전원이 켜질 때 자동으로 실행 (OracleTNSListener와 OracleServiceXE 자동 실행)
  - Listener와 Service가 켜져 있으면 DB 접근 가능해진 것

- **데이터 조회**
  - 조회시 사용하는 sql 문(SELECT): Query라고 하고, DQL(Data Query Language)이라고도 함
  - SQL문을 통해 데이터를 조회 시, 해당 데이터를 먼저 메모리영역에서 찾은 후, 메모리 영역에 해당 데이터가 없으면 물리적 파일을 찾는다. 찾으면 물리적 파일에서 메모리영역으로 다시 불러와 저장한 후, 사용자에게 반환해준다.
- **데이터 입력/수정/삭제/병합**
  - 데이터의 insert, update, delete, merge(병합) 시 사용되는 SQL문 : DML(Data Manipulation Language) 라고 함
  1. 데이터 입력
      - 사용자가 SQL 문을 통해 데이터를 insert하면 바로 파일에 저장되는 것이 아니라 메모리 영역에 해당 테이블 정보를 저장한다.
  2. 데이터 수정
      - update 시, A를 바로 A-로 변경하지 않고 메모리 영역의 변경사항 저장하는 부분에 해당 히스토리(변경사항)를 저장한다.
  3. 데이터 삭제
      - delete 시, 바로 데이터를 삭제하는 것이 아니라 메모리 영역에 따로 변경사항을 저장한다.

  - 입력/수정/삭제 시 변경사항 저장은 메모리 영역에서 이루어 지고, 이를 물리적 파일에 반영할지 취소할지 결정할 수 있음 (DML 만 가능!)
    - 변경사항 반영 : commit
    - 변경사항 반영 안함 : rollback
    - commit, rollback은 모두 DML 시에만 가능하다.  
  > :bulb: **왜 이런식으로 작동할까?**  
  > 변경사항와 원래 데이터를 따로 저장하지 않으면, rollback시 변경사항 취소(UNDO)하고 원래 데이터로 돌아가지 못 한다.  
  > _물리적 파일 중 UNDOTBS1.dbf 파일이 변경사항을 저장한 파일이라고 보면 됨  


## 테이블 구성요소
- 테이블 구성요소 보기 : `desc 테이블명`
  - 이름: 컬럼명
  - 유형: 데이터 타입

## 데이터 타입
### 1. 정수, 실수  
#### NUMBER(전체 자리수, 소수점 아래 자리수)
  - 정수 : NUMBER(6) :arrow_right: 6자리 정수
  - 실수 : NUMBER(5,2) :arrow_right: 정수 부분 3자리 + 소수점 아래 2자리

### 2. 문자  

  > 영문자 : 1 byte  
  > 한글 : 2 byte _(기본)_ ~ 3 byte

#### char(바이트수)
- :star: 고정길이 :star:
- 최대 byte : 2000 byte
- 길이가 고정된 데이터 저장시 좋음 _e.g. 성별(남/여)_  
- 예시 ) char(5) :point_right:  
   - 미리 5 byte의 공간을 만듦 :arrow_right: 이후 값 저장  
   - 저장데이터가 5byte 보다 작을 시, 메모리 면에서 낭비 되는 공간 발생  


#### varchar2(바이트수)
- :star: 가변길이 :star:
- 최대 byte : 4000 byte
- 입력값의 크기가 가변적인 데이터 저장시 좋음  
- 예시 ) varchar2(5) :point_right:  
   - 미리 할당하지 않고, 데이터가 저장될 때 데이터 크기에 맞게 공간 할당  
   - 입력값이 3 byte이면, 3 byte만큼의 공간만 만드는 것  

#### 대용량 데이터
- 최대 giga byte 단위까지 저장 가능
- 종류
  1. **CLOB** : 문자 데이터 저장
  2. **BLOB** : 바이너리 데이터 저장 (이미지 자체 저장 가능)

### 3. 날짜
#### Date
- YY/MM/DD 형태로 저장됨  
